<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>QuickSite Builder Pro</title>

<!-- Google Analytics -->
<script async src="https://www.googletagmanager.com/gtag/js?id=G-0K43KPF32W"></script>
<script>
window.dataLayer = window.dataLayer || [];
function gtag(){dataLayer.push(arguments);}
gtag('js', new Date());
gtag('config', 'G-0K43KPF32W');
</script>

<style>
*{box-sizing:border-box;margin:0;padding:0;font-family:system-ui}
body{background:#eef2ff;color:#111}

/* HEADER */
header{
  background:#4f46e5;color:white;padding:14px 16px;font-size:20px;font-weight:700;
}

/* TOP TOOLBAR */
.top-tools{
  display:flex;gap:8px;padding:10px;background:white;border-bottom:1px solid #ddd;position:sticky;top:0;z-index:10;flex-wrap:wrap;
}
.top-tools button{
  padding:10px 14px;border:none;border-radius:6px;cursor:pointer;font-weight:600;background:#e5e7eb;
}
.top-tools .primary{background:#4f46e5;color:white}
.top-tools .success{background:#10b981;color:white}
.top-tools .special{background:#f59e0b;color:white}

/* CANVAS */
#canvas{
  min-height:70vh;background:white;margin:16px;border-radius:10px;padding:12px;
}

/* SECTIONS */
.section{
  position:relative;margin-bottom:14px;border:2px dashed transparent;border-radius:8px;
}
.section:hover{border-color:#4f46e5}

/* CONTROLS */
.controls{
  position:absolute;top:6px;right:6px;display:flex;gap:4px;
}
.controls button{
  border:none;padding:6px 8px;border-radius:4px;cursor:pointer;background:#111;color:white;font-size:12px;
}

/* EDITABLE */
[contenteditable]:focus{
  outline:2px dashed #4f46e5;padding:4px;
}

/* MODALS */
.modal{display:none;position:fixed;inset:0;background:rgba(0,0,0,.6);align-items:center;justify-content:center;z-index:50;}
.modal-box{background:white;width:92%;max-width:480px;padding:20px;border-radius:12px;max-height:90vh;overflow-y:auto;}
.modal-box h3{margin-bottom:12px;}
.color-grid{display:grid;grid-template-columns:repeat(6,1fr);gap:8px;margin-bottom:12px;}
.color-box{height:32px;border-radius:6px;cursor:pointer;box-shadow:0 0 0 1px #ccc;}
.gradient-box{height:36px;border-radius:8px;cursor:pointer;}
input,textarea{width:100%;padding:10px;margin-bottom:10px;border:1px solid #ccc;border-radius:6px;}
button.action{padding:10px 14px;border:none;border-radius:6px;cursor:pointer;font-weight:600;background:#4f46e5;color:white;margin-right:8px;}
.image-preview{max-width:100%;max-height:200px;margin:10px 0;border-radius:8px;}
input[type="file"]{padding:8px;border:2px dashed #4f46e5;background:#f0f0f0;}
.template-option{padding:14px;margin:6px;background:#4f46e5;color:white;text-align:center;border-radius:8px;cursor:pointer;}
.template-option:hover{background:#3b3fc5;}
</style>
</head>
<body>

<header>‚ö° QuickSite Builder Pro</header>

<div class="top-tools">
  <button onclick="addSection('navbar')" class="special">üì± Navbar</button>
  <button onclick="openTemplateModal()">Templates</button>
  <button onclick="addSection('text')">Text</button>
  <button onclick="addSection('button')">Button</button>
  <button onclick="openImageModal()">üñºÔ∏è Image</button>
  <button onclick="addSection('footer')" class="special">üìÑ Footer</button>
  <button class="success" onclick="saveProject()">Save</button>
  <button class="primary" onclick="exportSite()">Export</button>
  <button onclick="openFeedback()">Feedback</button>
</div>

<div id="canvas"></div>

<!-- SETTINGS MODAL -->
<div class="modal" id="settingsModal">
  <div class="modal-box">
    <h3>üé® Section Settings</h3>
    <b>Text Color</b>
    <div class="color-grid" id="textColors"></div>

    <b>Background Color</b>
    <div class="color-grid" id="bgColors"></div>

    <b>Gradient</b>
    <div class="color-grid" id="gradients"></div>

    <b>Font Size</b>
    <input type="range" min="12" max="64" id="fontSizeRange">

    <button class="action" id="boldBtn">Bold</button>
    <button id="closeSettingsBtn">Close</button>
  </div>
</div>

<!-- IMAGE MODAL -->
<div class="modal" id="imageModal">
  <div class="modal-box">
    <h3>üñºÔ∏è Add Image</h3>
    
    <b>Option 1: Paste Image URL</b>
    <input type="text" id="imageUrlInput" placeholder="https://example.com/image.jpg">
    <button class="action" onclick="addImageFromUrl()">Add from URL</button>
    
    <p style="text-align:center;margin:10px 0">OR</p>
    
    <b>Option 2: Upload Image</b>
    <input type="file" id="imageUpload" accept="image/*" onchange="uploadImage()">
    
    <div id="imagePreviewDiv"></div>
    
    <button id="closeImageBtn">Close</button>
  </div>
</div>

<!-- FEEDBACK MODAL -->
<div class="modal" id="feedbackModal">
  <div class="modal-box">
    <h3>Feedback</h3>
    <textarea id="feedbackText" placeholder="What worked? What didn't?"></textarea>
    <button class="action" id="sendFeedbackBtn" onclick="sendFeedback()">Send</button>
    <button id="closeFeedbackBtn">Close</button>
  </div>
</div>

<!-- TEMPLATE MODAL -->
<div class="modal" id="templateModal">
  <div class="modal-box">
    <h3>Choose Template</h3>
    <div class="template-option" onclick="applyTemplate('landing')">Landing Page</div>
    <div class="template-option" onclick="applyTemplate('business')">Business</div>
    <div class="template-option" onclick="applyTemplate('portfolio')">Portfolio</div>
    <button id="closeTemplateBtn">Close</button>
  </div>
</div>

<!-- EXPORT MODAL -->
<div class="modal" id="exportModal">
  <div class="modal-box">
    <h3>üì¶ Export Your Website</h3>
    <p style="margin-bottom:12px;">Your website will download as <strong>my-website.html</strong>.</p>
    <button class="action" onclick="doExport()">‚¨áÔ∏è Download Now</button>
    <button id="closeExportBtn" onclick="exportModal.style.display='none'">Close</button>
    <div style="background:#f0fdf4;border:1px solid #bbf7d0;border-radius:8px;padding:14px;margin-top:14px;font-size:14px;line-height:1.7;">
      <strong style="color:#059669;">üåç Want a public link so anyone can visit your site?</strong><br><br>
      Upload your downloaded file to one of these <strong>free</strong> hosting platforms:<br><br>
      ‚Ä¢ <strong>Netlify Drop</strong> ‚Äî drag &amp; drop at <em>netlify.com/drop</em> ‚Äî live in 10 seconds<br>
      ‚Ä¢ <strong>GitHub Pages</strong> ‚Äî free hosting at <em>github.com</em><br>
      ‚Ä¢ <strong>Vercel</strong> ‚Äî fast &amp; free at <em>vercel.com</em><br>
      ‚Ä¢ <strong>Render</strong> ‚Äî free static hosting at <em>render.com</em><br><br>
      üöÄ <strong>Coming soon:</strong> Direct one-click hosting from inside QuickSite Builder!
    </div>
  </div>
</div>

<!-- EmailJS -->
<script type="text/javascript" src="https://cdn.jsdelivr.net/npm/@emailjs/browser@4/dist/email.min.js"></script>
<script>
(function(){
   emailjs.init("g4u3Hbi8VNF-WJZ5C");
})();
</script>

<script>
let selected=null;
let copiedHTML=null;
let currentImageData=null;
const canvas=document.getElementById('canvas');

const components={
navbar:`<div style="padding:16px 20px;background:#4f46e5;color:white;display:flex;justify-content:space-between;align-items:center;flex-wrap:wrap">
<div contenteditable style="font-size:24px;font-weight:700">MyBrand</div>
<div style="display:flex;gap:20px;flex-wrap:wrap">
<a contenteditable href="#" style="color:white;text-decoration:none">Home</a>
<a contenteditable href="#" style="color:white;text-decoration:none">About</a>
<a contenteditable href="#" style="color:white;text-decoration:none">Services</a>
<a contenteditable href="#" style="color:white;text-decoration:none">Contact</a>
</div>
</div>`,
hero:`<div contenteditable style="padding:80px 20px;text-align:center;background:#4f46e5;color:white">
<h1 style="font-size:48px">Build Your Website</h1>
<p style="font-size:20px">Click to edit</p>
</div>`,
text:`<div contenteditable style="padding:40px 20px">
<h2>Section Title</h2><p>Edit text here. You can change anything!</p>
</div>`,
button:`<div style="padding:40px;text-align:center">
<button contenteditable style="padding:14px 28px;background:#4f46e5;color:white;border:none;border-radius:6px;font-size:16px;cursor:pointer">Click Me</button>
</div>`,
image:`<div style="padding:40px;text-align:center">
<img src="https://via.placeholder.com/600x300" style="max-width:100%;border-radius:8px">
</div>`,
footer:`<div style="padding:40px 20px;background:#111827;color:white;text-align:center">
<div contenteditable style="margin-bottom:20px">
<h3 style="margin-bottom:10px">Your Company</h3>
<p>Building amazing websites since 2026</p>
</div>
<div contenteditable style="margin-bottom:20px">
<a href="#" style="color:#10b981;margin:0 10px">Facebook</a>
<a href="#" style="color:#10b981;margin:0 10px">Twitter</a>
<a href="#" style="color:#10b981;margin:0 10px">Instagram</a>
</div>
<p contenteditable style="font-size:14px;color:#9ca3af">¬© 2026 Your Company. All rights reserved.</p>
</div>`
};

// Template presets
const templates={
landing:[components.navbar, components.hero, components.text, components.button, components.footer],
business:[components.navbar, components.text, components.text, components.footer],
portfolio:[components.navbar, components.hero, components.image, components.footer]
};

// Color grids
const textColors=['#111','#ef4444','#10b981','#3b82f6','#f59e0b','#8b5cf6'];
const bgColors=['#ffffff','#f3f4f6','#e0e7ff','#ecfeff','#111827','#fef3c7'];
const gradients=[
  'linear-gradient(135deg,#667eea,#764ba2)',
  'linear-gradient(135deg,#10b981,#059669)',
  'linear-gradient(135deg,#f97316,#ef4444)',
  'linear-gradient(135deg,#3b82f6,#06b6d4)',
  'linear-gradient(135deg,#111827,#4f46e5)'
];

const textColorsDiv=document.getElementById('textColors');
textColors.forEach(c=>{
  const d=document.createElement('div'); d.className='color-box'; d.style.background=c;
  d.onclick=()=>setTextColor(c);
  textColorsDiv.appendChild(d);
});
const bgColorsDiv=document.getElementById('bgColors');
bgColors.forEach(c=>{
  const d=document.createElement('div'); d.className='color-box'; d.style.background=c;
  d.onclick=()=>setBg(c);
  bgColorsDiv.appendChild(d);
});
const gradientsDiv=document.getElementById('gradients');
gradients.forEach(g=>{
  const d=document.createElement('div'); d.className='gradient-box'; d.style.background=g;
  d.onclick=()=>setGradient(d);
  gradientsDiv.appendChild(d);
});

// Event listeners
document.getElementById('fontSizeRange').oninput=e=>setFont(e.target.value);
document.getElementById('boldBtn').onclick=toggleBold;
document.getElementById('closeSettingsBtn').onclick=()=>settingsModal.style.display='none';
document.getElementById('closeImageBtn').onclick=()=>imageModal.style.display='none';
document.getElementById('closeFeedbackBtn').onclick=()=>feedbackModal.style.display='none';
document.getElementById('closeTemplateBtn').onclick=()=>templateModal.style.display='none';

// SECTION FUNCTIONS
function addSection(type){
  if(type==='image'){openImageModal();return;}
  const d=document.createElement('div');d.className='section';
  d.innerHTML=components[type]+controls();
  d.onclick=()=>selected=d;
  canvas.appendChild(d);
  save();
}
function controls(){return `<div class="controls">
<button onclick="up(event)">‚Üë</button>
<button onclick="down(event)">‚Üì</button>
<button onclick="copySection(event)">üìã</button>
<button onclick="openSettings(event)">‚öôÔ∏è</button>
<button onclick="del(event)">‚úï</button>
</div>`;}
function up(e){e.stopPropagation();const s=e.target.closest('.section');if(s.previousElementSibling)s.before(s.previousElementSibling);save()}
function down(e){e.stopPropagation();const s=e.target.closest('.section');if(s.nextElementSibling)s.after(s.nextElementSibling);save()}
function del(e){e.stopPropagation();e.target.closest('.section').remove();save()}
function copySection(e){e.stopPropagation();copiedHTML=e.target.closest('.section').innerHTML;alert('Section copied!')}
function openSettings(e){e.stopPropagation();selected=e.target.closest('.section');settingsModal.style.display='flex'}
function setTextColor(c){if(selected)selected.querySelectorAll('[contenteditable],h1,h2,p,button,a').forEach(el=>el.style.color=c);}
function setBg(c){if(selected){selected.style.background=c;selected.style.backgroundImage='none'}}
function setGradient(el){if(selected)selected.style.backgroundImage=el.style.background}
function setFont(v){if(selected)selected.style.fontSize=v+'px'}
function toggleBold(){if(selected)selected.style.fontWeight=selected.style.fontWeight==='bold'?'normal':'bold'}

// IMAGE FUNCTIONS
function openImageModal(){
  imageModal.style.display='flex';
  document.getElementById('imageUrlInput').value='';
  document.getElementById('imagePreviewDiv').innerHTML='';
  currentImageData=null;
}
function addImageFromUrl(){
  const url=document.getElementById('imageUrlInput').value.trim();
  if(!url){alert('Please enter an image URL');return;}
  const d=document.createElement('div');d.className='section';
  d.innerHTML=`<div style="padding:40px;text-align:center"><img src="${url}" style="max-width:100%;border-radius:8px"></div>`+controls();
  d.onclick=()=>selected=d;
  canvas.appendChild(d);save();
  imageModal.style.display='none';alert('Image added!');
}
function uploadImage(){
  const file=document.getElementById('imageUpload').files[0];
  if(!file){return;}
  if(!file.type.startsWith('image/')){alert('Please select an image file');return;}
  const reader=new FileReader();
  reader.onload=function(e){
    currentImageData=e.target.result;
    document.getElementById('imagePreviewDiv').innerHTML=
      `<img src="${currentImageData}" class="image-preview">
       <button class="action" onclick="addUploadedImage()">Add This Image</button>`;
  };
  reader.readAsDataURL(file);
}
function addUploadedImage(){
  if(!currentImageData){alert('No image uploaded');return;}
  const d=document.createElement('div');d.className='section';
  d.innerHTML=`<div style="padding:40px;text-align:center"><img src="${currentImageData}" style="max-width:100%;border-radius:8px"></div>`+controls();
  d.onclick=()=>selected=d;
  canvas.appendChild(d);save();
  imageModal.style.display='none';alert('Image added!');
}

// FEEDBACK
function openFeedback(){feedbackModal.style.display='flex'}
function sendFeedback(){
  const feedback=document.getElementById('feedbackText').value;
  if(!feedback.trim()){alert('Please write some feedback');return;}

  // EmailJS does NOT work on file:// ‚Äî must be hosted on http or https
  if(location.protocol==='file:'){
    alert('‚ö†Ô∏è EmailJS cannot send emails when the file is opened directly from your device (file://).\n\nTo fix this:\n1. Upload this file to a web host (Netlify, GitHub Pages, etc.)\n2. OR open it via a local server (e.g. VS Code Live Server)\n\nYour feedback has been saved locally.');
    localStorage.setItem('qs_feedback',feedback);
    feedbackModal.style.display='none';
    document.getElementById('feedbackText').value='';
    return;
  }

  const btn=document.getElementById('sendFeedbackBtn');
  btn.disabled=true;
  btn.textContent='Sending...';

  emailjs.send("service_j971t5q","template_pzeai9x",{feedback: feedback})
    .then(()=>{
      gtag('event','feedback_sent',{event_category:'engagement',event_label:'feedback_modal'});
      alert("‚úÖ Thanks! Your feedback was sent.");
      localStorage.setItem('qs_feedback',feedback);
      feedbackModal.style.display='none';
      document.getElementById('feedbackText').value='';
    })
    .catch(err=>{
      const msg = err && err.text ? err.text : (err && err.status ? 'Status '+err.status : JSON.stringify(err));
      alert("‚ùå Email send failed: "+msg+"\n\nMake sure your EmailJS template variables match and your domain is allowed in EmailJS dashboard.");
    })
    .finally(()=>{btn.disabled=false;btn.textContent='Send';});
}

// TEMPLATE MODAL
function openTemplateModal(){templateModal.style.display='flex'}
function applyTemplate(name){
  canvas.innerHTML='';templates[name].forEach(c=>{
    const d=document.createElement('div');d.className='section';d.innerHTML=c+controls();d.onclick=()=>selected=d;
    canvas.appendChild(d);
  });
  templateModal.style.display='none';save();
}

// EXPORT / SAVE
function exportSite(){exportModal.style.display='flex'}
function doExport(){
  const html=`<!DOCTYPE html>
<html><head><meta charset="UTF-8"><meta name="viewport" content="width=device-width, initial-scale=1.0"><title>My Website</title></head>
<body style="margin:0;font-family:system-ui">${canvas.innerHTML.replace(/<div class="controls">[\s\S]*?<\/div>/g,'')}</body></html>`;
  const blob=new Blob([html],{type:'text/html'});const a=document.createElement('a');a.href=URL.createObjectURL(blob);a.download='my-website.html';a.click();
}
function save(){localStorage.setItem('qs_canvas',canvas.innerHTML)}
function saveProject(){save();alert('Project saved on this device!')}
window.onload=()=>canvas.innerHTML=localStorage.getItem('qs_canvas')||'';
</script>
</body>
                                                        </html>
      
